/*!
 * @ekoindia/aeps-gateway-lib v1.1.0
 * https://github.com/ekostore/aeps-gateway-lib
 * 
 * @copyright Eko (https://eko.in)
 * @license MIT found in the LICENSE file in the root directory.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.EkoAEPSGateway=e():t.EkoAEPSGateway=e()}(window,(function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n,o=0;o<e.length;o++)(n=e[o]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}n.r(e),n.d(e,"default",(function(){return r}));var r=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),console.warn("Library constructor loaded:: ",{win:window,doc:document,body:document.body}),this._GATEWAY_URL="https://gateway.eko.in/v2/aeps",this._UAT_GATEWAY_URL="https://stagegateway.eko.in/v2/aeps",this._config={env:"development",language:"en"},this._callbackUserFunc=null,this._popupWindow=null}return function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(t,[{key:"_confirmationCallback",value:function(t){this._callbackUserFunc&&t&&(t.origin===this._GATEWAY_URL||t.origin===this._UAT_GATEWAY_URL)&&t.data&&"debit-hook"===t.data.action&&this._callbackUserFunc(t.data)}},{key:"config",value:function(t){t&&(this._config=Object.assign(this._config,t))}},{key:"setCallbackURL",value:function(t,e){t&&(this._config.callback_url=t,e&&e.parameters&&"object"===o(e.parameters)&&(this._config.callback_url_custom_params=JSON.stringify(e.parameters)),e&&e.headers&&"object"===o(e.headers)&&(this._config.callback_url_custom_headers=JSON.stringify(e.headers)))}},{key:"setConfirmationCallbackFunction",value:function(t){t&&(this._callbackUserFunc=t,window.addEventListener("message",this._confirmationCallback.bind(this)))}},{key:"confirmTransaction",value:function(t){var e=t||{};e.action="go",e.allow=!0,this._popupWindow&&this._popupWindow.postMessage(e,"*")}},{key:"rejectTransaction",value:function(t){this._popupWindow&&this._popupWindow.postMessage({action:"go",allow:!1,message:t||""},"*")}},{key:"open",value:function(){if(null===this._popupWindow||this._popupWindow.closed){var t="production"===this._config.env||"prod"===this._config.env?this._GATEWAY_URL:this._UAT_GATEWAY_URL,e=document.createElement("form");for(var n in e.setAttribute("method","post"),e.setAttribute("action",t),e.setAttribute("target","ekogateway"),this._popupWindow=window.open("","ekogateway"),this._config)if(Object.prototype.hasOwnProperty.call(this._config,n)){var o=document.createElement("input");o.type="hidden",o.name=n,o.value=this._config[n],e.appendChild(o)}document.body.appendChild(e),e.submit()}else this._popupWindow.focus()}}]),t}()}])}));